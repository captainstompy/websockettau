{% from mytime import fmt_time %}

<!DOCTYPE html>
<html>
  <head>
    <title>{{ "Tau - Leaderboard" if player_name is None else ("Tau - %s's High Scores" % (player_name))}}</title>

    <script type="text/javascript" src="{{ static_url("jquery.js") }}"></script>
    <link rel="stylesheet" type="text/css" href="{{ static_url("reset.css") }}" />
    <link rel="stylesheet" type="text/css" href="{{ static_url("styles.css") }}" />
  </head>
  <body>
    <div class="leaderboard_menu">
    {% for (i, (leaderboard_type, leaderboard_type_label)) in enumerate(leaderboard_types) %}
    {% if leaderboard_type == selected_leaderboard_type and player_name is None %}
      <span>{{ leaderboard_type_label }}</span>
    {% else %}
      <a href="/leaderboard/{{ leaderboard_type }}">{{ leaderboard_type_label }}</a>
    {% end %}
    {% if i != len(leaderboard_types) - 1 %}|{% end %}
    {% end %}
    </div>
    
    <div class="leaderboard_menu">
    {% if player_name is not None %}
    <span>High scores for {{ player_name }}:</span>
    {% for (i, (leaderboard_type, leaderboard_type_label)) in enumerate(leaderboard_types) %}
    {% if leaderboard_type == selected_leaderboard_type %}
      <span>{{ leaderboard_type_label }}</span>
    {% else %}
      <a href="/leaderboard/{{ leaderboard_type }}/{{ player_name }}">{{ leaderboard_type_label }}</a>
    {% end %}
    {% if i != len(leaderboard_types) - 1 %}|{% end %}
    {% end %}
    {% end %}
    </div>
    
    {% for game_type in [3, 6] %}
    <div style="float:left; width:300px;padding:25px;">
      <h2>{{ game_type }} Tau</h2>
      {% for (num_players, scores) in all_high_scores[str(game_type) + "tau"].items() %}
        <h4>{{ num_players }} players</h4>
        <table class="leaderboard">
          <thead><tr><th>Time</th><th>Players</th><th>Date</th></tr></thead>
          <tbody>
          {% for score in scores %}
            <tr>
              <td>{{ fmt_time(score.elapsed_time) }}</td>
              <td>
                {% set processed_players = sorted(score.players, None, lambda x: x.name) %}
                {% for (i, player) in enumerate(processed_players) %}
                <a href="/leaderboard/{{ selected_leaderboard_type }}/{{ player.name }}">{{ player.name }}</a> ({{ score.player_scores()[player.name] }}){% if i != len(score.players) - 1 %}, {% end %}
                {% end %}
              </td>
              <td>{{ score.date.strftime("%b %d %Y %I:%M%p") }}</td>
            </tr>
          {% end %}
          </tbody>
        </table>
      {% end %}
    </div>
    {% end %}

    <div style="clear:both;"></div>
    
    <div>
      <a href="/">Back to games</a>
    </div>
  </body>
</html>
